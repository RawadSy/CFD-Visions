<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shell-and-Tube Heat Exchanger Background</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
<script>
// ----- Scene Setup -----
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias: true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ----- Lighting -----
const light = new THREE.PointLight(0xffffff, 2, 200);
light.position.set(10, 10, 10);
scene.add(light);

// ----- Create Tubes -----
const tubes = [];
const tubeMaterial = new THREE.MeshPhongMaterial({ color: 0x8888ff, transparent: true, opacity: 0.6 });

for (let i = -2; i <= 2; i++) {
  const tubeGeom = new THREE.CylinderGeometry(0.2, 0.2, 8, 32);
  const tube = new THREE.Mesh(tubeGeom, tubeMaterial);
  tube.rotation.z = Math.PI / 2;
  tube.position.y = i * 0.7;
  scene.add(tube);
  tubes.push(tube);
}

// ----- Shell -----
const shellGeom = new THREE.CylinderGeometry(3, 3, 9, 64, 1, true);
const shellMat = new THREE.MeshPhongMaterial({ color: 0xff4444, wireframe: true, opacity: 0.3, transparent: true });
const shell = new THREE.Mesh(shellGeom, shellMat);
shell.rotation.z = Math.PI / 2;
scene.add(shell);

// ----- Particles inside tubes -----
const particles = [];
const particleMaterial = new THREE.MeshBasicMaterial({ color: 0x00ffff });

tubes.forEach(tube => {
  for (let i = 0; i < 100; i++) {
    const sphere = new THREE.Mesh(new THREE.SphereGeometry(0.05, 8, 8), particleMaterial.clone());
    sphere.position.set(
      THREE.MathUtils.randFloatSpread(8),
      tube.position.y,
      THREE.MathUtils.randFloatSpread(0.2)
    );
    scene.add(sphere);
    particles.push({mesh: sphere, speed: 0.02 + Math.random()*0.02});
  }
});

// ----- Camera -----
camera.position.z = 12;

// ----- Animation -----
function animate() {
  requestAnimationFrame(animate);

  // Move particles inside tubes
  particles.forEach(p => {
    p.mesh.position.x += p.speed;
    if (p.mesh.position.x > 4) p.mesh.position.x = -4;
    // Color change (blue â†’ red)
    const heat = (p.mesh.position.x + 4) / 8;
    p.mesh.material.color.setHSL(0.6 - heat*0.6, 1, 0.5);
  });

  renderer.render(scene, camera);
}
animate();

// Resize handler
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
